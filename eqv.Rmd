---
title: "Use of eqv package for visualization of the NOAA earthquake dataset"
author: "Nilesh Dighe"
date: "March 11, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Package eqv allows clean up & visualization of the NOAA earthquake dataset.  The document describes some of the functionalities available in the eqv package.


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(chron)
library(stringr)
library(ggplot2)
library(leaflet)
source("./R source code/eq_clean_data.R")
source("./R source code/eq_location_clean.R")
source("./R source code/geom_timeline.R")
source("./R source code/GeomTimeline.R")
source("./R source code/GeomTimelineLabel.R")
source("./R source code/geom_timeline_label.R")
source("./R source code/theme_timeline.R")
source("./R source code/eq_map.R")
source("./R source code/eq_create_label.R")
filename <- system.file("extdata/signif.txt", package = "eqv")
data <- readr::read_delim(filename, delim = "\t")
data %>%
  eq_clean_data() %>%
  eq_location_clean %>%
  filter(COUNTRY %in% c("INDIA", "ITALY"), YEAR > 1990) %>%
  ggplot(aes(x  = DATE, y = COUNTRY,color = as.numeric(TOTAL_DEATHS),size = as.numeric(EQ_PRIMARY)))+ geom_timeline() + geom_timeline_label(aes(label = LOCATION_NAME), n_max = 5) + theme_timeline()

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

# Example below shows use if leaflet mapping function

```{r echo=FALSE, message=FALSE}
data %>% 
  eq_clean_data() %>% 
  dplyr::filter(COUNTRY == "MEXICO" & lubridate::year(DATE) >= 2000) %>% 
  dplyr::mutate(popup_text = eq_create_label(.)) %>% 
  eq_map(annot_col = "popup_text")
```

